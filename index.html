<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Legend</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

        /* Warna Dasar: Putih dan Hijau */
        :root {
            --color-primary: #10B981; /* Hijau Emerald */
            --color-secondary: #059669;
            --color-background: #F8F8F8;
            --color-text: #333333;
            --color-light-text: #6B7280;
            --color-card-bg: #FFFFFF;
            --color-border: #E5E7EB;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--color-background);
            color: var(--color-text);
            min-height: 100vh;
            padding-top: 20px;
            box-sizing: border-box;
        }

        #welcome-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
            text-align: center;
        }

        #welcome-page h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-light-text);
            margin-bottom: 0.5rem;
        }

        #welcome-page .welcome-title {
            font-size: 3rem;
            font-weight: 700;
            color: var(--color-primary);
            margin: 0.5rem 0 3rem 0;
            white-space: pre-line;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #start-btn {
            background-color: var(--color-primary);
            color: #FFFFFF;
            padding: 1rem 3rem;
            border: none;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px 0 rgba(16, 185, 129, 0.4);
            letter-spacing: 0.05em;
        }
        /* Animasi Hover dan Active untuk Start Button */
        #start-btn:hover {
            background-color: var(--color-secondary);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(16, 185, 129, 0.6);
        }
        #start-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.2);
        }

        .main-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--color-primary);
        }

        .datetime {
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--color-light-text);
            padding: 8px 15px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            background-color: var(--color-card-bg);
            font-weight: 600;
        }

        .regional-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
            justify-items: center;
            max-height: calc(100vh - 250px); 
            overflow-y: auto;
            padding-right: 5px;
        }

        /* Tombol Regional dan User */
        .regional-btn, .user-btn, .back-btn {
            background-color: var(--color-card-bg);
            color: var(--color-text);
            border: 1px solid var(--color-border);
            padding: 1rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .regional-btn:hover, .user-btn:hover, .back-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
            box-shadow: 0 4px 10px rgba(16, 185, 129, 0.2);
            transform: translateY(-2px); /* Efek melayang saat hover */
        }
        .regional-btn:active, .user-btn:active, .back-btn:active {
            transform: translateY(0); /* Efek tertekan saat aktif */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .user-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100px;
            padding: 0.5rem;
            font-weight: 600;
            text-align: center;
        }
        
        .users-grid > * {
            width: 100%;
            height: 100px;
        }


        .content-container {
            padding: 1.5rem;
            box-sizing: border-box;
            background-color: var(--color-card-bg);
            border-radius: 12px;
            border: 1px solid var(--color-border);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            max-height: calc(100vh - 40px); 
            overflow-y: auto;
        }
        
        .user-details-text h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--color-primary);
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr)); 
            gap: 8px;
        }

        /* --- STYLING TOMBOL LINK --- */
        .number-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700; /* Dibuat lebih tebal karena hanya angka */
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.1s; /* Transisi lebih cepat untuk efek tekan */
            padding: 0.75rem 0.5rem; 
            background-color: #E5E7EB;
            border: 1px solid #D1D5DB;
            color: var(--color-text);
            text-decoration: none;
            box-shadow: 0 3px 0 0 #D1D5DB; /* Bayangan untuk efek 3D awal */
        }

        .number-btn:hover {
            transform: translateY(-1px);
            background-color: #D1D5DB;
            box-shadow: 0 4px 0 0 #D1D5DB; /* Bayangan saat hover */
        }

        .number-btn:active {
            transform: translateY(2px); /* Dorong ke bawah */
            box-shadow: 0 1px 0 0 #D1D5DB; /* Bayangan tipis saat tertekan */
        }

        .number-btn.disabled {
            background-color: #F9FAFB;
            border-color: #E5E7EB;
            color: #C0C0C0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .number-btn.clicked {
            background-color: var(--color-primary);
            border-color: var(--color-secondary);
            color: #FFFFFF;
            box-shadow: 0 3px 0 0 var(--color-secondary);
        }

        .number-btn.clicked:hover {
            background-color: var(--color-secondary);
            box-shadow: 0 4px 0 0 var(--color-secondary);
        }

        .number-btn.clicked:active {
             transform: translateY(2px);
             box-shadow: 0 1px 0 0 var(--color-secondary);
        }

        @media (max-width: 768px) {
            .regional-grid {
                grid-template-columns: repeat(1, 1fr);
            }
            .users-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .number-grid {
                grid-template-columns: repeat(1, 1fr); 
            }
        }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="max-w-xl mx-auto">
        <div id="welcome-page" class="fade-transition" style="opacity: 1;">
            <h2>WELCOME TO</h2>
            <h1 class="welcome-title">PROJECT LEGEND</h1>
            <button id="start-btn" aria-label="Press start to continue">PRESS START TO CONTINUE</button>
        </div>
        <div id="main-view" class="fade-transition" style="display: none; opacity: 0;">
            <h1 class="main-title text-center">PROJECT LEGEND</h1>
            <div id="datetime" class="datetime"></div>
            
            <div id="regional-buttons-container" class="regional-grid">
                <button class="regional-btn" data-region="jakarta" aria-label="Select Jakarta region">JAKARTA</button>
                <button class="regional-btn" data-region="balikpapan" aria-label="Select Balikpapan region">BALIKPAPAN</button>
                <button class="regional-btn" data-region="makassar" aria-label="Select Makassar region">MAKASSAR</button>
                <button class="regional-btn" data-region="jayapura" aria-label="Select Jayapura region">JAYAPURA</button>
                <button class="regional-btn" data-region="semarang" aria-label="Select Semarang region">SEMARANG</button>
                <button class="regional-btn" data-region="sorong" aria-label="Select Sorong region">SORONG</button>
                <button class="regional-btn" data-region="manado" aria-label="Select Manado region">MANADO</button>
            </div>
            
            <div id="back-to-regional-container" class="mb-4" style="display: none;"></div>

            <div id="user-buttons-container" class="users-grid" style="display: none;"></div>
        </div>
        <div id="content-display-area"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let clickedNumbers = JSON.parse(localStorage.getItem('clickedNumbers')) || {};
            
            // --- KONFIGURASI LINK PER KOTA (Untuk menghitung nomor urut global) ---
            const CITY_LINK_COUNTS = {
                'jakarta': 50,
                'balikpapan': 30,
                'makassar': 50,
                'jayapura': 40,
                'semarang': 50,
                'sorong': 50,
                'manado': 50,
            };

            // --- MASTER DATA: USER DAN LINK SPESIFIK (Default Links Diisi Dummy) ---
            // SILAKAN GANTI ISI ARRAY 'links: []' di bawah ini dengan URL yang sebenarnya.
            const ALL_USERS_DATA = {
                // JAKARTA (50 links per user)
                'rondang': { name: 'Rondang', city: 'Jakarta', links: Array(50).fill('')},
                'neneng': { name: 'Neneng', city: 'Jakarta', links: Array(50).fill('')},
                'mawar': { name: 'Mawar', city: 'Jakarta', links: Array(50).fill('')},
                'evie': { name: 'Evie', city: 'Jakarta', links: Array(50).fill('')},
                'rossi': { name: 'Rossi', city: 'Jakarta', links: Array(50).fill('')},
                'sri': { name: 'Sri', city: 'Jakarta', links: Array(50).fill('')},
                'sulastri': { name: 'Sulastri', city: 'Jakarta', links: Array(50).fill('')},
                'pasuleny': { name: 'Pasuleny', city: 'Jakarta', links: Array(50).fill('')},
                'poppy': { name: 'Poppy', city: 'Jakarta', links: Array(50).fill('')},
                'yohana': { name: 'Yohana', city: 'Jakarta', links: Array(50).fill('')},
                
                // BALIKPAPAN (30 links per user)
                'irmawati': { name: 'Irmawati', city: 'Balikpapan', links: Array(30).fill('')},
                'fitriani': { name: 'Fitriani', city: 'Balikpapan', links: Array(30).fill('')},
                'ita': { name: 'Ita', city: 'Balikpapan', links: Array(30).fill('')},
                'aisyah': { name: 'Aisyah', city: 'Balikpapan', links: Array(30).fill('')},
                'riskianur': { name: 'Riskianur', city: 'Balikpapan', links: Array(30).fill('')},
                'vita': { name: 'Vita', city: 'Balikpapan', links: Array(30).fill('')},
                'sribp': { name: 'Sri', city: 'Balikpapan', links: Array(30).fill('')},
                
                // MAKASSAR (50 links per user)
                'tenri': { name: 'Tenri', city: 'Makassar', links: Array(50).fill('')},
                'irman': { name: 'Irman', city: 'Makassar', links: Array(50).fill('')},
                'nilawati': { name: 'Nilawati', city: 'Makassar', links: Array(50).fill('')},
                'waode': { name: 'Waode', city: 'Makassar', links: Array(50).fill('')},

                // JAYAPURA (40 links per user)
                'yohan': { name: 'Yohan', city: 'Jayapura', links: Array(40).fill('')},
                'tamsil': { name: 'Tamsil', city: 'Jayapura', links: Array(40).fill('')},
                'dahlan': { name: 'Dahlan', city: 'Jayapura', links: Array(40).fill('')},
                'ali': { name: 'Ali', city: 'Jayapura', links: Array(40).fill('')},

                // SEMARANG (50 links per user)
                'neni': { name: 'Neni', city: 'Semarang', links: Array(50).fill('')},
                'rita': { name: 'Rita', city: 'Semarang', links: Array(50).fill('')},
                'dewi': { name: 'Dewi', city: 'Semarang', links: Array(50).fill('')},
                'dimas': { name: 'Dimas', city: 'Semarang', links: Array(50).fill('')},
                
                // SORONG (50 links per user)
                'maria': { name: 'Maria', city: 'Sorong', links: Array(50).fill('')},
                'nuhun': { name: 'Nuhun', city: 'Sorong', links: Array(50).fill('')},
                'sokihiun': { name: 'Sokihiun', city: 'Sorong', links: Array(50).fill('')},

                // MANADO (50 links per user)
                'fatmawaty': { name: 'Fatmawaty', city: 'Manado', links: Array(50).fill('')},
                'selvie': { name: 'Selvie', city: 'Manado', links: Array(50).fill('')}, 
                'hartin': { name: 'Hartin', city: 'Manado', links: Array(50).fill('')},
                'irma': { name: 'Irma', city: 'Manado', links: Array(50).fill('')}, 
            
                'monita': { name: 'Monita', city: 'Manado', links: ['https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmzaEXKz7igXY', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm6epkkJGsxEF', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm3Mx5vM%2FnHOP', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm1wYH%252BG%252Btzb%252B', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmz3tB1ary4Fu', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm7VU7TcfQ9BN', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmw0DH2bei%252BpP', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm3lJuSbllBpE', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmxljFGFQZs46', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9wNAibaybfP', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9ivFw9LAB4u', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm2tXPmMqwo%252BC', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9iZGoj2dYFB', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm0xfCgXX2Bjr', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmwpdjMWdv%252B12', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm6j3j74NlRAb', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm%252BNvmR%2FK%252Bhb7', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm0%252Bx8QLW%2FAar', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmyK1Fza8lM8T', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmy5Bg9lxLiX8', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm67Qr76hRoZ%252B', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9RAKuvS1f%2FY', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmxnXQVAn%2Fvx3', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmzas1s9rKv3e', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm3UMzm9TO1vd', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm2srD95PZpsB', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmznYR937qZzx', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9XyOGKqU%252B55', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmxROpYewCjOs', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm0vLChMKNPxY', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm6EYwEad2ldn', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmzjVetK4GTV7', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm0Nbweu8Oq0j', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm4ktKi6pQRtc', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm4w7ccP6Fu2%252B', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm%2FJEhhCiZ%252Bxt', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm6a8MJunkxIf', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm%2F%252B%252Bgn5lzSDi', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm9f9xYytbhO0', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm%2FxTgSD31NWQ', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm2943ob4ZyMj', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm890IkFsSiVg', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmyLsHlM2Q9gZ', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm6qxsd4GhLUe', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm%252BdKx4s5MTIv', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm7%2FSI8J1zohv', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm4%252BWD7XSv80b', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm7YPDLUgUX5b', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunm59aPXrGJLgh', 'https://questionpro.com/a/TakeSurvey?tt=HY7P6L6F5MHBDnBMUEunmxUZO35poYSr'] },
};

            const CITY_TO_USERS = {
                'jakarta': ['rondang', 'neneng', 'mawar', 'evie', 'rossi', 'sri', 'sulastri', 'pasuleny', 'poppy', 'yohana'],
                'balikpapan': ['irmawati', 'fitriani', 'ita', 'aisyah', 'riskianur', 'vita', 'sribp'],
                'makassar': ['tenri', 'irman', 'nilawati', 'waode'],
                'jayapura': ['yohan', 'tamsil', 'dahlan', 'ali'],
                'semarang': ['neni', 'rita', 'dewi', 'dimas'],
                'sorong': ['maria', 'nuhun', 'sokihiun'],
                'manado': ['fatmawaty', 'selvie', 'hartin', 'irma', 'monita'],
            };

            let GLOBAL_LINK_MAP = {}; 
            
            // Fungsi untuk menghitung penomoran global dan mengisi link
            function initializeGlobalLinks() {
                let globalCounter = 11; // Mulai dari 11
                const cityOrder = Object.keys(CITY_TO_USERS);

                for (const city of cityOrder) {
                    const userIds = CITY_TO_USERS[city];

                    userIds.forEach(userId => {
                        const userData = ALL_USERS_DATA[userId];
                        
                        // Gunakan link yang ada (dummy atau real)
                        const linksToUse = userData.links;
                        
                        GLOBAL_LINK_MAP[userId] = [];
                        
                        linksToUse.forEach(url => {
                            GLOBAL_LINK_MAP[userId].push({
                                globalIndex: globalCounter++,
                                url: url || 'javascript:void(0)' // Gunakan JS void(0) jika link kosong
                            });
                        });
                    });
                }
            }


            // --- Utility Functions (Element & Screen Management) ---
            const welcomePage = document.getElementById('welcome-page');
            const startBtn = document.getElementById('start-btn');
            const mainView = document.getElementById('main-view');
            const userButtonsContainer = document.getElementById('user-buttons-container');
            const contentDisplayArea = document.getElementById('content-display-area');
            const regionalButtonsContainer = document.getElementById('regional-buttons-container');
            const backToRegionalContainer = document.getElementById('back-to-regional-container');

            function generateUserButtons(region) {
                userButtonsContainer.innerHTML = '';
                backToRegionalContainer.innerHTML = '';
                
                const backButton = document.createElement('button');
                backButton.className = 'back-btn w-full';
                backButton.textContent = '← Kembali ke Pilihan Kota';
                backButton.addEventListener('click', () => {
                    regionalButtonsContainer.style.display = 'grid';
                    userButtonsContainer.style.display = 'none';
                    backToRegionalContainer.style.display = 'none';
                    contentDisplayArea.innerHTML = ''; 
                    userButtonsContainer.innerHTML = '';
                    backToRegionalContainer.innerHTML = '';
                });

                backToRegionalContainer.appendChild(backButton);
                backToRegionalContainer.style.display = 'block';

                const userIds = CITY_TO_USERS[region] || [];
                userIds.forEach(userId => {
                    const user = ALL_USERS_DATA[userId];
                    if (!user) return;

                    const userButton = document.createElement('button');
                    userButton.className = 'user-btn';
                    userButton.textContent = user.name;
                    userButton.dataset.target = userId;
                    userButton.dataset.region = region;
                    userButtonsContainer.appendChild(userButton);
                });

                showScreen('main-view');
                userButtonsContainer.style.display = 'grid';
            }

            function generateUserContent(user, userId) {
                contentDisplayArea.innerHTML = '';
                
                const userLinksWithIndex = GLOBAL_LINK_MAP[userId] || [];
                const totalLinks = userLinksWithIndex.length;
                
                const userDetailsHTML = `
                    <div class="user-details-text">
                        <h3 class="font-bold text-lg">${user.name}</h3>
                        <ul class="list-none p-0 mt-2">
                            <li><span class="font-semibold">- ID :</span> ${userId}</li>
                            <li><span class="font-semibold">- Kota :</span> ${user.city}</li>
                            <li><span class="font-semibold">- Total Link :</span> ${totalLinks}</li>
                        </ul>
                    </div>
                `;
                
                // Buat tombol link
                let numberGridHTML = '';

                userLinksWithIndex.forEach(linkObj => {
                    const linkLabel = `${linkObj.globalIndex}`; // HANYA ANGKA
                    const linkUrl = linkObj.url; 
                    const linkId = `${userId}-${linkObj.globalIndex}`;
                    const isClicked = clickedNumbers[linkId] ? 'clicked' : '';
                    // Menambahkan kondisi disabled
                    const isDisabled = (linkUrl === 'javascript:void(0)' || linkUrl.trim() === '') ? 'disabled' : ''; 
                    
                    numberGridHTML += `<a href="${linkUrl}" target="_blank" rel="noopener noreferrer" class="number-btn ${isClicked} ${isDisabled}" data-link-id="${linkId}">${linkLabel}</a>`;
                });

                const newContentWrapper = document.createElement('div');
                newContentWrapper.id = userId;
                newContentWrapper.className = 'content-container fade-transition';
                newContentWrapper.style.display = 'none';
                newContentWrapper.style.opacity = '0';
                newContentWrapper.innerHTML = `
                    <button class="back-btn mb-4 w-full" aria-label="Back to city menu">← Kembali ke Menu Kota</button>
                    ${userDetailsHTML}
                    <div class="number-grid">${numberGridHTML}</div>
                `;
                contentDisplayArea.appendChild(newContentWrapper);

                newContentWrapper.querySelector('.back-btn').addEventListener('click', () => {
                    showScreen('main-view');
                    const region = ALL_USERS_DATA[userId].city.toLowerCase();
                    generateUserButtons(region);
                });
            }

            // Fungsi lain (updateDateTime, showScreen, Event Listeners) tidak berubah

            function updateDateTime() {
                const now = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', timeZone: 'Asia/Jakarta' };
                document.getElementById('datetime').textContent = now.toLocaleString('id-ID', options);
            }

            function showScreen(screenToShow) {
                const allScreens = [welcomePage, mainView, ...Array.from(contentDisplayArea.children)];
                allScreens.forEach(screen => {
                    screen.style.display = 'none';
                    screen.style.opacity = '0';
                });

                const screen = document.getElementById(screenToShow);
                if (screen) {
                    screen.style.display = 'block';
                    setTimeout(() => screen.style.opacity = '1', 50);
                }
            }

            regionalButtonsContainer.addEventListener('click', function(event) {
                const target = event.target.closest('.regional-btn');
                if (target) {
                    const region = target.dataset.region;
                    generateUserButtons(region);
                    regionalButtonsContainer.style.display = 'none';
                }
            });

            userButtonsContainer.addEventListener('click', function(event) {
                const target = event.target.closest('.user-btn');
                if (target) {
                    const userId = target.dataset.target;
                    const user = ALL_USERS_DATA[userId]; 
                    
                    if (user) {
                        backToRegionalContainer.style.display = 'none';
                        userButtonsContainer.style.display = 'none';
                        
                        generateUserContent(user, userId);
                        showScreen(userId);
                    }
                }
            });

            document.addEventListener('click', function(event) {
                const target = event.target.closest('a.number-btn:not(.disabled)');
                if (target) {
                    const linkId = target.dataset.linkId;
                    if (linkId) {
                        clickedNumbers[linkId] = true;
                        localStorage.setItem('clickedNumbers', JSON.stringify(clickedNumbers));
                        target.classList.add('clicked');
                    }
                }
            });

            startBtn.addEventListener('click', () => {
                welcomePage.style.opacity = '0';
                setTimeout(() => {
                    showScreen('main-view');
                    regionalButtonsContainer.style.display = 'grid'; 
                    userButtonsContainer.style.display = 'none';
                    backToRegionalContainer.style.display = 'none';
                }, 500);
            });

            // --- Initialization ---
            initializeGlobalLinks();
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });
    </script>
</body>
</html>
